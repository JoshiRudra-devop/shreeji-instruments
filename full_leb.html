<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="img/png" href="images/logo512.png" />
    <title>Lab Calibration Report</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Arial', sans-serif;
            background-color: white;
            color: black;
            margin: 0 10px;
        }
        nav {
            background-color: #00796b;
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        nav ul {
            list-style: none;
            display: flex;
            gap: 15px;
        }
        nav ul li {
            display: inline;
        }
        nav ul li a {
            text-decoration: none;
            color: white;
            font-weight: bold;
            transition: color 0.3s ease;
        }
        nav ul li a:hover {
            color: #ffccbc;
        }
        header {
            background: url('https://via.placeholder.com/1200x400') no-repeat center center/cover;
            height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
            font-size: 32px;
            font-weight: bold;
            text-align: center;
        }
        @media (max-width: 600px) {
            header {
                font-size: 20px;
            }
        }
        .container {
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            margin: 20px;
        }
        h2.centered {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
        }
        .title_input_pair {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }
        label {
            font-weight: bold;
        }
        input, textarea {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            width: 100%;
            padding: 12px;
            margin: 1%;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #45a049;
        }
        .level-input-container, .ctm-input-container, .TS-input-container, .slumcone-input-container ,.cylinder-input-container,.sandReplacement-input-container {
            display: none;
            margin-top: 10px;
        }
        .level-input-container input,
        .ctm-input-container input,
        .TS-input-container input,
        .slumcone-input-container,
        .cylinder-input-container,
        .sandReplacement-input-container input {
            display: block;
            margin: 8px 0;
            padding: 8px;
            width: 100%;
            max-width: 300px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

    <nav>
        <h1 style="color: white;">Shreeji Instruments</h1>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Contact</a></li>
        </ul>
    </nav>
    <header>GENERATE FULL LEB CERTIFICATES AT THE SAME TIME</header>        

    <div class="container">
        <h2 class="centered">COMPANY DETAILS</h2>
        <form id="calibrationForm">
            <div class="compnaydetails">
                <div class="title_input_pair">
                    <label for="partyName">Name of COMPANY:</label>
                    <input type="text" id="partyName" required>
                </div>
                <div class="title_input_pair">
                    <label for="calibrationDate">Date of Calibration:</label>
                    <input type="date" id="calibrationDate" required>
                </div>
                <div class="title_input_pair">
                    <label for="siteLocation">Site Location:</label>
                    <input type="text" id="siteLocation" required>
                </div>
                <div class="title_input_pair">
                    <label for="nextCalibrationDate">Next Suggested Date:</label>
                    <input type="date" id="nextCalibrationDate" required>
                </div>
                <div class="title_input_pair">
                    <label for="personResponsible">Calibration By:</label>
                    <input type="text" id="personResponsible" required>
                </div>
                <div class="title_input_pair">
                    <label for="certificateNumber">FIRST CERTIFICATE NUMBERE:</label>
                    <input type="text" id="certificateNumber" required>
                </div>
            </div>
            <div class="instrumentsinfo">

                <div class="autolevel">     
                    <div class="title_input_pair">
                        <label><input type="checkbox" id="Autolevel"> Auto level</label>
                    </div>
                    <div id="LevelinputContainer" class="level-input-container">
                        <div class="title_input_pair">
                            <label for="serial no">Serial No:</label>
                            <input type="text" id="levelserialno" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="make">Make:</label>
                            <input type="text" id="levelmake" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="model">Model:</label>
                            <input type="text" id="levelmodel" required>
                        </div> 
                    </div>
                </div> 

                <div class="ctm">
                    <div class="title_input_pair">
                        <label><input type="checkbox" id="CTM"> Cube Testing Machine</label>
                    </div>
                    <div id="ctminputContainer" class="ctm-input-container">
                        <div class="title_input_pair">
                            <label for="serial no">SERIAL NO:</label>
                            <input type="text" id="ctmserialno" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="make">MAKE:</label>
                            <input type="text" id="ctmmake" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="Capacity">CAPICITY:</label>
                            <input type="text" id="ctmcapacity" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input1">Load on 200 kn:</label>
                            <input type="text" id="input1" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input2">Load on 400 kn:</label>
                            <input type="text" id="input2" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input3">Load on 600 kn:</label>
                            <input type="text" id="input3" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input4">Load on 800 kn:</label>
                            <input type="text" id="input4" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input5">Load on 1000 kn:</label>
                            <input type="text" id="input5" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input6">Load on 1200 kn:</label>
                            <input type="text" id="input6" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input7">Load on 1400 kn:</label>
                            <input type="text" id="input7" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input8">Load on 1600 kn:</label>
                            <input type="text" id="input8" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input9">Load on 1800 kn:</label>
                            <input type="text" id="input9" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="input10">Load on 2000 kn:</label>
                            <input type="text" id="input10" required>
                        </div>
                    </div>
                </div>

                <div class="totalStation">
                    <div class="title_input_pair">
                        <label><input type="checkbox" id="totalStation"> Total Station</label>
                    </div> 
                    <div id="TSinputContainer" class="TS-input-container">
                        <div class="title_input_pair">
                            <label for="serial no">Serial No:</label>
                            <input type="text" id="ts_serialno" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="make">Make:</label>
                            <input type="text" id="tsmake" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="model">Model:</label>
                            <input type="text" id="ts_model" required>
                        </div> 
                    </div>
                </div>

                <div class="measuring_cylinder">
                    <div class="title_input_pair">
                        <label><input type="checkbox" id="measuring_cylinder"> Slumcone</label>
                    </div>
                    <div id="cylinderinputContainer" class="cylinder-input-container">
                        <div class="title_input_pair">
                            <label for="serial no">Serial No:</label>
                            <input type="text" id="cylinder_serialno" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="make">Make:</label>
                            <input type="text" id="cylinder_make" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="Capacity">CAPICITY:</label>
                            <input type="text" id="cylinder_capacity" required>
                        </div>
                    </div>
                </div>
                <div class="sand_replacement">
                    <div class="title_input_pair">
                        <label><input type="checkbox" id="sand_replacement"> SAND REPLACEMENT KIT</label>
                    </div>
                    <div id="sandReplacementinputContainer" class="sandReplacement-input-container">
                        <div class="title_input_pair">
                            <label for="serial no">Serial No:</label>
                            <input type="text" id="sand_replacement_sr" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="make">Make:</label>
                            <input type="text" id="sand_replacement_make" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="Capacity">CAPICITY:</label>
                            <input type="text" id="sand_replacement_capacity" required>
                        </div>
                    </div>
                </div>
                <div class="slumcone">
                    <div class="title_input_pair">
                        <label><input type="checkbox" id="slumcone"> MEASURING CYLINDER </label>
                    </div>
                    <div id="slumconeinputContainer" class="slumcone-input-container">
                        <div class="title_input_pair">
                            <label for="serial no">Serial No:</label>
                            <input type="text" id="slumcone_serialno" required>
                        </div>
                        <div class="title_input_pair">
                            <label for="make">Make:</label>
                            <input type="text" id="slumcone_make" required>
                        </div>
                    </div>
                </div>
            </div>

            <button type="button" onclick="generatePDF()">Generate Certificate PDF</button>
            <button type="button" onclick="preview()">Show Preview</button>
            <button type="button" onclick="withleterhade()">Generate Certificate with out letterhead</button>
        </form>
    </div>

    <script>
        // Initialize jsPDF
const { jsPDF } = window.jspdf;

// Toggle input containers based on checkbox selection
const toggleInputContainer = (checkboxId, containerId) => {
    document.getElementById(checkboxId).addEventListener('change', function() {
        document.getElementById(containerId).style.display = this.checked ? 'block' : 'none';
    });
};

toggleInputContainer('Autolevel', 'LevelinputContainer');
toggleInputContainer('CTM', 'ctminputContainer');
toggleInputContainer('totalStation', 'TSinputContainer');
toggleInputContainer('slumcone', 'slumconeinputContainer');
toggleInputContainer('measuring_cylinder', 'cylinderinputContainer');
toggleInputContainer('sand_replacement', 'sandReplacementinputContainer');

function addImg(doc) {      
        const img = new Image();
      img.src = 'footer.jpeg';
      doc.addImage(img, 'PNG', 0, 255, 210, 27);
     
      const img3 = new Image();
      img.src = 'sign.jpeg';
      doc.addImage(img, 'PNG', 160, 225, 40, 10);

      const img1 = new Image();
      img.src = 'stamp.jpeg';
      doc.addImage(img, 'PNG', 110, 215, 40, 35);

      const img2 = new Image();
      img.src = 'header.jpeg';
      doc.addImage(img, 'PNG', 3, 3, 210, 30);
}

function preview() {
    const doc = new jsPDF();
    // addImg(doc);


    generateCertificate(doc); // Generate PDF content
    const pdfBlob = doc.output('blob');
    const pdfURL = URL.createObjectURL(pdfBlob);

    const previewFrame = document.createElement('iframe');
    previewFrame.style.width = "100%";
    previewFrame.style.height = "600px";
    previewFrame.src = pdfURL;

    const container = document.querySelector('.container');
    const existingPreview = document.querySelector('iframe');
    if (existingPreview) container.removeChild(existingPreview);
    container.appendChild(previewFrame);
}

function generatePDF() {
    const doc = new jsPDF();
    generateCertificate(doc);
    const partyName = document.getElementById('partyName').value;
    const calibrationDate = document.getElementById('calibrationDate').value;
    const siteLocation = document.getElementById('siteLocation').value;
    doc.save(` ${siteLocation} ${partyName} ${calibrationDate} calibration_certificates.pdf`);
}

function withleterhade() {
    const doc = new jsPDF();
    // generateCertificate(doc); 
    const partyName = document.getElementById('partyName').value;
    const siteLocation = document.getElementById('siteLocation').value;
    const calibrationDate= document.getElementById("calibrationDate").value.split("-").reverse().join("/");
    const nextCalibrationDate = document.getElementById('nextCalibrationDate').value;
    const personResponsible = document.getElementById('personResponsible').value;
    const certificateNumber = document.getElementById('certificateNumber').value;
    let firstPage = true;

            // Generate certificate for Cube Testing Machine if selected
            if (document.getElementById('Autolevel').checked) {
                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                const serialNo = document.getElementById('levelserialno').value;
                const make = document.getElementById('levelmake').value;
                const modelNo = document.getElementById('levelmodel').value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 60, { align: 'center' });
                
                doc.setFontSize(15);
                doc.setFont("helvetica", "simple");   
                doc.text(`DATE:${calibrationDate}`, 155, 45);
                //   doc.text(`REF No:${certificateNumber}`, 10, 45)


                
                doc.text(`FOR , ${make}  AUTO LEVEL`, doc.internal.pageSize.getWidth() / 2, 65, {  align: 'center' });
                doc.text(`MODLE : ${modelNo}  ,SR NO:- ${serialNo}`, doc.internal.pageSize. getWidth() / 2,70, { align: 'center' });
                // Certificate Details
                
                // doc.text(`NAME OF PARTY         :     ${partyName}`, 14, 85);
                doc.text(`NAME OF PARTY         :      ${partyName}`, 14, 85);
                doc.text(`EQUIPMENT NAME      :     AUTO LEVEL`, 14, 95);
                doc.text(`SERIAL NO                   :     ${serialNo}`, 14, 105);
                doc.text(`MAKE                            :     ${make}`, 14, 115);
                doc.text(`MODEL NO                   :     ${modelNo} `, 14, 125);
                doc.text(`NEXT DUE DATE         :     ${nextCalibrationDate}`, 14, 135);
                doc.text(`DATE                             :     ${calibrationDate}`, 14, 145);

                doc.setFontSize(12);
                doc.text(`This is to certify that ${make} Automatic Level-${modelNo} Serial No ${serialNo} Been Checked `, 14, 155);
                doc.text(` By us as under One year warranty.`, 14, 160);
                doc.text(`1. Level was kept At a distance of 20 meter from staff-A and 30 meter from Staff-B, Which `, 14, 170);
                doc.text(`were ).Pre-fixed at same level in our workshop (permanent bench-mark of same elevation).`, 14, 175);
                doc.text(`2. Reading of Staff-A was taken as 1,600`, 14, 180);
                doc.text(`3. Reading of Staff-B was taken as 1,600 .`, 14, 185);
                doc.text(`Hence error is NIL (Within the tolerance Level). Therefore, instrument is found free from  `, 14, 195);
                doc.text(`collimation error as of Date.`, 14, 200);

                // Footer
                doc.text("FOR, Shreeji Instruments", 140, 208);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }

            // Generate certificate for Cube Testing Machine if selected
            if (document.getElementById('CTM').checked) {
                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                // addimage(); 

                const serialNo = document.getElementById('ctmserialno').value;
                const make = document.getElementById('ctmmake').value;
                const capacity = document.getElementById('ctmcapacity').value;
                const inputs = [];
                for (let i = 1; i <= 10; i++) {
                    inputs.push(document.getElementById(`input${i}`).value);
                }

                doc.setFont("Cloister Black Font", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: "center" });
                doc.setFontSize(10);

                doc.setFont("helvetica", "bold");
                doc.setFontSize(12);
                doc.text(`Date:-    ${calibrationDate}`, 140, 60);
                doc.text(`Name of Party      :-    ${partyName}`, 14, 70);
                doc.text(`Instrument name :-    CUBE TESTING MACHINE`, 14, 80);
                doc.text(`Capacity  / MAKE  :-    ${capacity}  /  ${make}`, 14, 90);
                doc.text(`Serial No                :-    ${serialNo}`, 14, 100);
                doc.text(`Next Due Date:-    ${nextCalibrationDate}`, 140, 100);
                doc.text(`Site Location         :-    ${siteLocation}`, 14, 110); 

                doc.setFontSize(10);
                doc.setFont("helvetica", "bold");

                doc.text(`CALIBRATION INSTRUMENT 2000KN`, 14, 120);  
                doc.text(`PROVING RING NO:2000KN 094 IS 4169:2014`, 14, 125);  
                doc.text(`CALIBRATED BY : NATIONAL COUNCIL FOR CEMENT AND BUILDING MATERIALS`, 14, 130);  
                doc.setFont("helvetica", "bold");
                doc.setFontSize(11);
                const startX = 13;
                const startY = 142;
                const cellWidth = 30;
                const cellHeight = 7;

                doc.text(`Divisions`, 18, 141);
                doc.text(`KN`, 174, 141);

                const fixedTexts = ["Deflection In", "LOAD IN KN", "1st set in KN", "2nd set in KN", "3rd set in KN", "AVERAGE in"];

                for (let k = 0; k < 6; k++) {
                const x = startX + k * cellWidth;
                doc.rect(x, 132, cellWidth, 10);
                doc.text(fixedTexts[k], x + 2, 137);
                }

                const fixedValuesColumn1 = ["84.1", "168.6", "254.7", "342.1", "429.1", "513.9", "600.9", "689.2", "776.7", "865.8"];
                const fixedValuesColumn2 = ["200", "400", "600", "800", "1000", "1200", "1400", "1600", "1800", "2000"];

                for (let i = 0; i < 10; i++) {
                for (let j = 0; j < 6; j++) {
                    const x = startX + j * cellWidth;
                    const y = startY + i * cellHeight;
                    doc.rect(x, y, cellWidth, cellHeight);

                    let textValue = "";
                    if (j === 0) textValue = fixedValuesColumn1[i];
                    else if (j === 1) textValue = fixedValuesColumn2[i];
                    else textValue = inputs[i];

                    // Centering the text horizontally within the cell
                    const textWidth = doc.getTextWidth(textValue); // Get the width of the text
                    const centeredX = x + (cellWidth - textWidth) / 2; // Calculate centered X position
                    doc.text(textValue, centeredX, y + 6); // Draw the text centered
                }
                }
                doc.text(`Calibration By      :-   ${personResponsible}`, 14, 225); 
                doc.text("FOR, Shreeji Instruments", 150, 225);


                doc.text("Proprietor", 174, 235);

             }
            
            // Generate certificate for TOTAL STATION  if selected
            if (document.getElementById('totalStation').checked) {
                if (!firstPage) {
                    doc.addPage();
                    }   
                const make = document.getElementById("tsmake").value;
                const serialN= document.getElementById("ts_serialno").value;
                const modelNo= document.getElementById("ts_model").value;


                doc.setFont("helvetica", "bold");
                doc.setFontSize(15);
                doc.text(`TEST CERTIFICATE FOR`,  doc.internal.pageSize.getWidth() / 2, 37,{ align: 'center' });
                doc.text("ELECTRONIC TOTAL STATION", doc.internal.pageSize.getWidth() /2,42,{ align: 'center' });
                doc.setFontSize(25);   
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 52, { align: 'center' });

                
                doc.setFont("helvetica", "simple"); 
                doc.setFontSize(15);  
                
                doc.text(`NAME OF PARTY          :     ${partyName}`, 14, 60);
                doc.text(`EQUIPMENT NAME    :     ELECTRONIC TOTAL STATION`, 14, 68);
                doc.text(`SERIAL NO                     :     ${serialNo}`, 14, 76);
                doc.text(`MAKE                              :     ${make}`, 14, 84);
                doc.text(`MODEL NO                     :     ${modelNo} `, 14, 92);
                doc.text(`NEXT DUE DATE         :     ${nextCalibrationDate}`, 14, 100);
                doc.text(`DATE                               :     ${calibrationDate}`, 14, 108);

                doc.setFontSize(12);
                doc.setFont("helvetica", "bold");
                doc.text(`i. GENERAL CHECKING AS UNDER. `, 14, 115);
                doc.text(`ii. HORIZONTAL CIRCLE CHECKED AS UNDER. `, 14, 140);
                doc.text(`iii. VERTICAL CIRCLE CHECKED AS UNDER.`, 14, 170);


                doc.setFont("helvetica", "simple");   
                doc.text(`•Diaphragm of the Instrument checked. Found Satisfactory`, 14, 120);
                doc.text(`•Optical Plummet checked in all 360 Degrees. Found Satisfactory `, 14, 125);
                doc.text(`•Bubble checked in all 360 degrees. Found Accurate.`, 14, 130);

                doc.text(`•Set Circle reading 0 degree, 0 minute, 0 second, point sighted 'X' approx. 30 meter away from the instrument.`, 14, 145);
                doc.text(`•Telescope reversed. Point sighted Y' approx. 15 meter away from instrument. `, 14, 150);
                doc.text(`•Alidade rotated through 180 degrees, O minute, O second, sighted point 'X' again. `, 14, 155);
                doc.text(`•Telescope reversed. It automatically sighted point 'Y' Error - Nil.`, 14, 160);


                doc.text(`•Sighted Telescope at a clearly defined object. (Point 'X' approx. 30 meter away from the Instrument) `, 14, 175);
                doc.text(`•Vertical Circle reading was 90 degree, O minute, O second.`, 14, 180);
                doc.text(`•Reversed Telescope, rotated alidade through 180 degrees, sighted same point, vertical circle Reading was 270  `, 14, 185);
                doc.text(` degrees, 0 minutes, 0 seconds, Hence Error-Nil. `, 14, 190);
                doc.text(`•Therefore the Electronic Total Station is certified as free from collimation error as date & Error - Nil`, 14, 200);


                // Footer
                doc.text("FOR, Shreeji Instruments", 145, 208);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);

             }
             
             // Generate certificate for SLUM CONE  if selected
            if (document.getElementById('slumcone').checked) {
                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                // addimage(); 

                const make= document.getElementById("slumcone_make").value;
                const serialNo= document.getElementById("slumcone_serialno").value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: 'center' });

                doc.setFontSize(10);
                doc.text("SHREEJI INSTRUMENTS: Calibration laboratory certifies that the instrument has been inspected, tested,", 12, 60);
                doc.text("and calibrated in accordance with documented procedures using measuring and test equipment traceable", 12, 65);
                doc.text("to international standards.", 12, 70);

                doc.setFontSize(12);
                // Certificate Details
                doc.text(`Date: ${calibrationDate}`, 140, 80);
                doc.text(`Name of Party         :     ${partyName}`, 14, 95);
                doc.text(`Instrument Name    :     SLUMCONE `, 14, 110);
                doc.text(`Serial No / Make     :     ${serialNo} / ${make}`, 14, 125);
                doc.text(`Site Location           :     ${siteLocation}`, 14, 140);
                doc.text(`Next Due Date         :     ${nextCalibrationDate}`, 14, 155);
                doc.text(`Calibration By         :     ${personResponsible}`, 14, 170);

                // Footer
                doc.text("FOR, Shreeji Instruments", 130, 210);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }
                        
            // Generate certificate for MEASURING CYLINDER if selected
            if (document.getElementById('measuring_cylinder').checked) {

                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                // addImg(); 

                const make= document.getElementById("cylinder_make").value;
                const serialNo= document.getElementById("cylinder_serialno").value;
                const capacity= document.getElementById("cylinder_capacity").value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: 'center' });

                doc.setFontSize(10);
                doc.text("SHREEJI INSTRUMENTS: Calibration laboratory certifies that the instrument has been inspected, tested,", 12, 60);
                doc.text("and calibrated in accordance with documented procedures using measuring and test equipment traceable", 12, 65);
                doc.text("to international standards.", 12, 70);

                doc.setFontSize(12);
                // Certificate Details
                doc.text(`Date: ${calibrationDate}`, 140, 80);
                doc.text(`Name of Party         :     ${partyName}`, 14, 95);
                doc.text(`Instrument Name    :     MEASURING CYLINDER `, 14, 110);
                doc.text(`Capacity            :     ${capacity}`, 14, 125);
                doc.text(`Serial No / Make     :     ${serialNo} / ${make}`, 14, 140);
                doc.text(`Site Location           :     ${siteLocation}`, 14, 155);
                doc.text(`Next Due Date         :     ${nextCalibrationDate}`, 14, 170);
                doc.text(`Calibration By         :     ${personResponsible}`, 14, 185);

                // Footer
                doc.text("FOR, Shreeji Instruments", 130, 210);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }
           
             // Generate certificate for SAND REPLACEMENT KIT if selected
            if (document.getElementById('sand_replacement').checked) {

                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                // addimage(); 

                const make= document.getElementById("sand_replacement_make").value;
                const serialNo= document.getElementById("sand_replacement_sr").value;
                const capacity= document.getElementById("sand_replacement_capacity").value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: 'center' });

                doc.setFontSize(10);
                doc.text("SHREEJI INSTRUMENTS: Calibration laboratory certifies that the instrument has been inspected, tested,", 12, 60);
                doc.text("and calibrated in accordance with documented procedures using measuring and test equipment traceable", 12, 65);
                doc.text("to international standards.", 12, 70);

                doc.setFontSize(12);
                // Certificate Details
                doc.text(`Date: ${calibrationDate}`, 140, 80);
                doc.text(`Name of Party         :     ${partyName}`, 14, 95);
                doc.text(`Instrument Name    :     SAND REPLACEMENT KIT  `, 14, 110);
                doc.text(`Capacity            :     ${capacity}`, 14, 125);
                doc.text(`Serial No / Make     :     ${serialNo} / ${make}`, 14, 140);
                doc.text(`Site Location           :     ${siteLocation}`, 14, 155);
                doc.text(`Next Due Date         :     ${nextCalibrationDate}`, 14, 170);
                doc.text(`Calibration By         :     ${personResponsible}`, 14, 185);

                // Footer
                doc.text("FOR, Shreeji Instruments", 130, 210);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }
            doc.save(`${siteLocation} ${partyName} ${calibrationDate} calibration_certificates.pdf`);

}

function generateCertificate(doc) {
    const partyName = document.getElementById('partyName').value;
    calibrationDate= document.getElementById("calibrationDate").value.split("-").reverse().join("/");
    const siteLocation = document.getElementById('siteLocation').value;
    const nextCalibrationDate = document.getElementById('nextCalibrationDate').value;
    const personResponsible = document.getElementById('personResponsible').value;
    const certificateNumber = document.getElementById('certificateNumber').value;
    let firstPage = true;

            // Generate certificate for Cube Testing Machine if selected
            if (document.getElementById('Autolevel').checked) {
                if (!firstPage) {
                    doc.addPage();
                }
                addImg(doc);
                firstPage = false;
                const serialNo = document.getElementById('levelserialno').value;
                const make = document.getElementById('levelmake').value;
                const modelNo = document.getElementById('levelmodel').value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 60, { align: 'center' });
                
                doc.setFontSize(15);
                doc.setFont("helvetica", "simple");   
                doc.text(`DATE:${calibrationDate}`, 155, 45);
                //   doc.text(`REF No:${certificateNumber}`, 10, 45)


                
                doc.text(`FOR , ${make}  AUTO LEVEL`, doc.internal.pageSize.getWidth() / 2, 65, {  align: 'center' });
                doc.text(`MODLE : ${modelNo}  ,SR NO:- ${serialNo}`, doc.internal.pageSize. getWidth() / 2,70, { align: 'center' });
                // Certificate Details
                
                // doc.text(`NAME OF PARTY         :     ${partyName}`, 14, 85);
                doc.text(`NAME OF PARTY         :      ${partyName}`, 14, 85);
                doc.text(`EQUIPMENT NAME      :     AUTO LEVEL`, 14, 95);
                doc.text(`SERIAL NO                   :     ${serialNo}`, 14, 105);
                doc.text(`MAKE                            :     ${make}`, 14, 115);
                doc.text(`MODEL NO                   :     ${modelNo} `, 14, 125);
                doc.text(`NEXT DUE DATE         :     ${nextCalibrationDate}`, 14, 135);
                doc.text(`DATE                             :     ${calibrationDate}`, 14, 145);

                doc.setFontSize(12);
                doc.text(`This is to certify that ${make} Automatic Level-${modelNo} Serial No ${serialNo} Been Checked `, 14, 155);
                doc.text(` By us as under One year warranty.`, 14, 160);
                doc.text(`1. Level was kept At a distance of 20 meter from staff-A and 30 meter from Staff-B, Which `, 14, 170);
                doc.text(`were ).Pre-fixed at same level in our workshop (permanent bench-mark of same elevation).`, 14, 175);
                doc.text(`2. Reading of Staff-A was taken as 1,600`, 14, 180);
                doc.text(`3. Reading of Staff-B was taken as 1,600 .`, 14, 185);
                doc.text(`Hence error is NIL (Within the tolerance Level). Therefore, instrument is found free from  `, 14, 195);
                doc.text(`collimation error as of Date.`, 14, 200);

                // Footer
                doc.text("FOR, Shreeji Instruments", 140, 208);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }

            // Generate certificate for Cube Testing Machine if selected
            if (document.getElementById('CTM').checked) {
                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                addImg(doc); 

                const serialNo = document.getElementById('ctmserialno').value;
                const make = document.getElementById('ctmmake').value;
                const capacity = document.getElementById('ctmcapacity').value;
                const inputs = [];
                for (let i = 1; i <= 10; i++) {
                    inputs.push(document.getElementById(`input${i}`).value);
                }

                doc.setFont("Cloister Black Font", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: "center" });
                doc.setFontSize(10);

                doc.setFont("helvetica", "bold");
                doc.setFontSize(12);
                doc.text(`Date:-    ${calibrationDate}`, 140, 60);
                doc.text(`Name of Party      :-    ${partyName}`, 14, 70);
                doc.text(`Instrument name :-    CUBE TESTING MACHINE`, 14, 80);
                doc.text(`Capacity  / MAKE  :-    ${capacity}  /  ${make}`, 14, 90);
                doc.text(`Serial No                :-    ${serialNo}`, 14, 100);
                doc.text(`Next Due Date:-    ${nextCalibrationDate}`, 140, 100);
                doc.text(`Site Location         :-    ${siteLocation}`, 14, 110); 

                doc.setFontSize(10);
                doc.setFont("helvetica", "bold");

                doc.text(`CALIBRATION INSTRUMENT 2000KN`, 14, 120);  
                doc.text(`PROVING RING NO:2000KN 094 IS 4169:2014`, 14, 125);  
                doc.text(`CALIBRATED BY : NATIONAL COUNCIL FOR CEMENT AND BUILDING MATERIALS`, 14, 130);  
                doc.setFont("helvetica", "bold");
                doc.setFontSize(11);
                const startX = 13;
                const startY = 142;
                const cellWidth = 30;
                const cellHeight = 7;

                doc.text(`Divisions`, 18, 141);
                doc.text(`KN`, 174, 141);

                const fixedTexts = ["Deflection In", "LOAD IN KN", "1st set in KN", "2nd set in KN", "3rd set in KN", "AVERAGE in"];

                for (let k = 0; k < 6; k++) {
                const x = startX + k * cellWidth;
                doc.rect(x, 132, cellWidth, 10);
                doc.text(fixedTexts[k], x + 2, 137);
                }

                const fixedValuesColumn1 = ["84.1", "168.6", "254.7", "342.1", "429.1", "513.9", "600.9", "689.2", "776.7", "865.8"];
                const fixedValuesColumn2 = ["200", "400", "600", "800", "1000", "1200", "1400", "1600", "1800", "2000"];

                for (let i = 0; i < 10; i++) {
                for (let j = 0; j < 6; j++) {
                    const x = startX + j * cellWidth;
                    const y = startY + i * cellHeight;
                    doc.rect(x, y, cellWidth, cellHeight);

                    let textValue = "";
                    if (j === 0) textValue = fixedValuesColumn1[i];
                    else if (j === 1) textValue = fixedValuesColumn2[i];
                    else textValue = inputs[i];

                    // Centering the text horizontally within the cell
                    const textWidth = doc.getTextWidth(textValue); // Get the width of the text
                    const centeredX = x + (cellWidth - textWidth) / 2; // Calculate centered X position
                    doc.text(textValue, centeredX, y + 6); // Draw the text centered
                }
                }
                doc.text(`Calibration By      :-   ${personResponsible}`, 14, 225); 
                doc.text("FOR, Shreeji Instruments", 150, 225);


                doc.text("Proprietor", 174, 235);

             }
            
            // Generate certificate for TOTAL STATION  if selected
            if (document.getElementById('totalStation').checked) {
                if (!firstPage) {
                    doc.addPage();
                    }   
                addImg(doc);
                const make = document.getElementById("tsmake").value;
                const serialNo= document.getElementById("ts_serialno").value;
                const modelNo= document.getElementById("ts_model").value;


                doc.setFont("helvetica", "bold");
                doc.setFontSize(15);
                doc.text(`TEST CERTIFICATE FOR`,  doc.internal.pageSize.getWidth() / 2, 37,{ align: 'center' });
                doc.text("ELECTRONIC TOTAL STATION", doc.internal.pageSize.getWidth() /2,42,{ align: 'center' });
                doc.setFontSize(25);   
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 52, { align: 'center' });

                
                doc.setFont("helvetica", "simple"); 
                doc.setFontSize(15);  
                
                doc.text(`NAME OF PARTY          :     ${partyName}`, 14, 60);
                doc.text(`EQUIPMENT NAME    :     ELECTRONIC TOTAL STATION`, 14, 68);
                doc.text(`SERIAL NO                     :     ${serialNo}`, 14, 76);
                doc.text(`MAKE                              :     ${make}`, 14, 84);
                doc.text(`MODEL NO                     :     ${modelNo} `, 14, 92);
                doc.text(`NEXT DUE DATE         :     ${nextCalibrationDate}`, 14, 100);
                doc.text(`DATE                               :     ${calibrationDate}`, 14, 108);

                doc.setFontSize(12);
                doc.setFont("helvetica", "bold");
                doc.text(`i. GENERAL CHECKING AS UNDER. `, 14, 115);
                doc.text(`ii. HORIZONTAL CIRCLE CHECKED AS UNDER. `, 14, 140);
                doc.text(`iii. VERTICAL CIRCLE CHECKED AS UNDER.`, 14, 170);


                doc.setFont("helvetica", "simple");   
                doc.text(`•Diaphragm of the Instrument checked. Found Satisfactory`, 14, 120);
                doc.text(`•Optical Plummet checked in all 360 Degrees. Found Satisfactory `, 14, 125);
                doc.text(`•Bubble checked in all 360 degrees. Found Accurate.`, 14, 130);

                doc.text(`•Set Circle reading 0 degree, 0 minute, 0 second, point sighted 'X' approx. 30 meter away from the instrument.`, 14, 145);
                doc.text(`•Telescope reversed. Point sighted Y' approx. 15 meter away from instrument. `, 14, 150);
                doc.text(`•Alidade rotated through 180 degrees, O minute, O second, sighted point 'X' again. `, 14, 155);
                doc.text(`•Telescope reversed. It automatically sighted point 'Y' Error - Nil.`, 14, 160);


                doc.text(`•Sighted Telescope at a clearly defined object. (Point 'X' approx. 30 meter away from the Instrument) `, 14, 175);
                doc.text(`•Vertical Circle reading was 90 degree, O minute, O second.`, 14, 180);
                doc.text(`•Reversed Telescope, rotated alidade through 180 degrees, sighted same point, vertical circle Reading was 270  `, 14, 185);
                doc.text(` degrees, 0 minutes, 0 seconds, Hence Error-Nil. `, 14, 190);
                doc.text(`•Therefore the Electronic Total Station is certified as free from collimation error as date & Error - Nil`, 14, 200);


                // Footer
                doc.text("FOR, Shreeji Instruments", 145, 208);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);

             }
             
             // Generate certificate for SLUM CONE  if selected
            if (document.getElementById('slumcone').checked) {
                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                addImg(doc); 

                const make= document.getElementById("slumcone_make").value;
                const serialNo= document.getElementById("slumcone_serialno").value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: 'center' });

                doc.setFontSize(10);
                doc.text("SHREEJI INSTRUMENTS: Calibration laboratory certifies that the instrument has been inspected, tested,", 12, 60);
                doc.text("and calibrated in accordance with documented procedures using measuring and test equipment traceable", 12, 65);
                doc.text("to international standards.", 12, 70);

                doc.setFontSize(12);
                // Certificate Details
                doc.text(`Date: ${calibrationDate}`, 140, 80);
                doc.text(`Name of Party         :     ${partyName}`, 14, 95);
                doc.text(`Instrument Name    :     SLUMCONE `, 14, 110);
                doc.text(`Serial No / Make     :     ${serialNo} / ${make}`, 14, 125);
                doc.text(`Site Location           :     ${siteLocation}`, 14, 140);
                doc.text(`Next Due Date         :     ${nextCalibrationDate}`, 14, 155);
                doc.text(`Calibration By         :     ${personResponsible}`, 14, 170);

                // Footer
                doc.text("FOR, Shreeji Instruments", 130, 210);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }
                        
            // Generate certificate for MEASURING CYLINDER if selected
            if (document.getElementById('measuring_cylinder').checked) {

                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                addImg(doc);
 

                const make= document.getElementById("cylinder_make").value;
                const serialNo= document.getElementById("cylinder_serialno").value;
                const capacity= document.getElementById("cylinder_capacity").value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: 'center' });

                doc.setFontSize(10);
                doc.text("SHREEJI INSTRUMENTS: Calibration laboratory certifies that the instrument has been inspected, tested,", 12, 60);
                doc.text("and calibrated in accordance with documented procedures using measuring and test equipment traceable", 12, 65);
                doc.text("to international standards.", 12, 70);

                doc.setFontSize(12);
                // Certificate Details
                doc.text(`Date: ${calibrationDate}`, 140, 80);
                doc.text(`Name of Party         :     ${partyName}`, 14, 95);
                doc.text(`Instrument Name    :     MEASURING CYLINDER `, 14, 110);
                doc.text(`Capacity            :     ${capacity}`, 14, 125);
                doc.text(`Serial No / Make     :     ${serialNo} / ${make}`, 14, 140);
                doc.text(`Site Location           :     ${siteLocation}`, 14, 155);
                doc.text(`Next Due Date         :     ${nextCalibrationDate}`, 14, 170);
                doc.text(`Calibration By         :     ${personResponsible}`, 14, 185);

                // Footer
                doc.text("FOR, Shreeji Instruments", 130, 210);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }
           
             // Generate certificate for SAND REPLACEMENT KIT if selected
            if (document.getElementById('sand_replacement').checked) {

                if (!firstPage) {
                    doc.addPage();
                }
                firstPage = false;
                addImg(doc);

                const make= document.getElementById("sand_replacement_make").value;
                const serialNo= document.getElementById("sand_replacement_sr").value;
                const capacity= document.getElementById("sand_replacement_capacity").value;

                doc.setFont("helvetica", "bold");
                doc.setFontSize(25);
                doc.text("CALIBRATION CERTIFICATE", doc.internal.pageSize.getWidth() / 2, 50, { align: 'center' });

                doc.setFontSize(10);
                doc.text("SHREEJI INSTRUMENTS: Calibration laboratory certifies that the instrument has been inspected, tested,", 12, 60);
                doc.text("and calibrated in accordance with documented procedures using measuring and test equipment traceable", 12, 65);
                doc.text("to international standards.", 12, 70);

                doc.setFontSize(12);
                // Certificate Details
                doc.text(`Date: ${calibrationDate}`, 140, 80);
                doc.text(`Name of Party         :     ${partyName}`, 14, 95);
                doc.text(`Instrument Name    :     SAND REPLACEMENT KIT  `, 14, 110);
                doc.text(`Capacity            :     ${capacity}`, 14, 125);
                doc.text(`Serial No / Make     :     ${serialNo} / ${make}`, 14, 140);
                doc.text(`Site Location           :     ${siteLocation}`, 14, 155);
                doc.text(`Next Due Date         :     ${nextCalibrationDate}`, 14, 170);
                doc.text(`Calibration By         :     ${personResponsible}`, 14, 185);

                // Footer
                doc.text("FOR, Shreeji Instruments", 130, 210);

                // Images and Signature (same as before)
                
                doc.text("Proprietor", 170, 225);
            }
 }

    </script>
</body>
</html>
